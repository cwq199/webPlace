<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>

// 题目：实现add(1)(2)(3)
// 普通做法

//柯理化 主要有3个作用： 参数复用、提前返回和 延迟执行

function curry(fn){
    //获取fn参数的数量
    var n = fn.length;
     //声明一个数组args
     var args = [];
     //返回一个匿名函数
    return  function(arg){
          //将curryIt后面括号中的参数放入数组
        args.push(arg)
        //如果args中的参数个数小于fn函数的参数个数，
         //则执行arguments.callee（其作用是引用当前正在执行的函数，这里是返回的当前匿名函数）。
         //否则，返回fn的调用结果
        if(args.length<n){
            return arguments.callee   // callee返回正在执行的函数本身的引用
        }else{
            return fn.apply('',args)
        }
    }
}


        // const curry = (fn, ...args) =>
        //     // 函数的参数个数可以直接通过函数数的.length属性来访问
        //     args.length >= fn.length // 这个判断很关键！！！
        //         // 传入的参数大于等于原始函数fn的参数个数，则直接执行该函数
        //         ? fn(...args)
        //         /**
        //          * 传入的参数小于原始函数fn的参数个数时
        //          * 则继续对当前函数进行柯里化，返回一个接受所有参数（当前参数和剩余参数） 的函数
        //         */
        //         : (..._args) => curry(fn, ...args, ..._args);

        // function add1(x, y, z) {
        //     return x + y + z;
        // }
        // const add = curry(add1);
        // console.log(add(1, 2, 3));
        // console.log(add(1)(2)(3));
        // console.log(add(1, 2)(3));
        // console.log(add(1)(2, 3)); 
        // 注意箭头函数的使用
       var curry = (fn, ...args) =>
            args.length >= fn.length
                ? fn(...args)
                : (..._args) => curry(fn, ...args, ..._args)



        function add1(x, y, z) {
            return x + y + z;
        }
        const add = curry(add1);
        console.log(add(1, 2, 3));
        console.log(add(1)(2)(3));
        console.log(add(1, 2)(3));
        console.log(add(1)(2, 3));

        //    无限加长版
 /*        function argsSum(args) {
            return args.reduce((pre, cur) => {
                return pre + cur
            })
        }
        function add(...args1) {
            let sum1 = argsSum(args1)
            let fn = function (...args2) {
                let sum2 = argsSum(args2)
                return add(sum1 + sum2)
            }
            fn.toString = function () {
                return sum1
            }
            return fn
        } */

    </script>
</body>

</html>